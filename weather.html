<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weather App</title>
  <link rel="stylesheet" href="weather.css">
</head>
<body>

<div class="container">
  <div class="weather_container">

    <div class="temp">
      <p>20°C</p>
    </div>

    <div class="time_location">
      <p>Delhi</p>
      <span>12:58 Monday 2022-09-26</span>
    </div>

    <div class="condition">
      <p>Weather:</p>
      <p>Mist</p>
    </div>

  </div>
</div>

<nav>
  <form>
    <input type='text' class="search_area" placeholder="Search for a location" />
    <br>
    <button type="submit">Search</button>
  </form>
</nav>

<script>
  const temperatureField = document.querySelector(".temp p");
  const locationField = document.querySelector(".time_location p");
  const dateAndTimeField = document.querySelector(".time_location span");
  const conditionField = document.querySelector(".condition p:nth-child(2)");
  const searchField = document.querySelector(".search_area");
  const form = document.querySelector("form");

  form.addEventListener("submit", searchForLocation);

  let target = "Lucknow";
// http://api.weatherapi.com/v1/current.json?key=d4d313d39be4441db9c81728251807&q=mumbai&aqi=no
  const fetchResults = async (targetLocation) => {
      let url = `https://api.weatherapi.com/v1/current.json?key=d4d313d39be4441db9c81728251807&q=${targetLocation}&aqi=no`;
      const res = await fetch(url);
      const data = await res.json();

      console.log(data);

      let locationName = data.location.name;
      let time = data.location.localtime;
      let temp = data.current.temp_c;
      let condition = data.current.condition.text;

      updateDetails(temp, locationName, time, condition);
    };

  function updateDetails(temp, locationName, time, condition) {
    let splitDate = time.split(" ")[0];
    let splitTime = time.split(" ")[1];
    let currentDay = getDayName(new Date(splitDate).getDay());

    temperatureField.innerText = `${temp}°C`;
    locationField.innerText = locationName;
    dateAndTimeField.innerText = `${splitDate} ${currentDay} ${splitTime}`;
    conditionField.innerText = condition;
  }

  function searchForLocation(e) {
    e.preventDefault();
    target = searchField.value;
    fetchResults(target);
  }
fetchResults(target);

  function getDayName(number) {
    switch (number) {
      case 0: return "Sunday";
      case 1: return "Monday";
      case 2: return "Tuesday";
      case 3: return "Wednesday";
      case 4: return "Thursday";
      case 5: return "Friday";
      case 6: return "Saturday";
     
    }
  }

</script>

</body>
</html>
